<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>UniRestorer</title>
    <link href="./files/style.css" rel="stylesheet">
    <script type="text/javascript" src="./files/jquery.mlens-1.0.min.js"></script>
    <script type="text/javascript" src="./files/jquery.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
<div class="content">
    <h2 align="center"><strong>UniRestorer: Universal Image Restoration via Adaptively <br> Estimating Image Degradation at Proper Granularity</strong></h2>

    <p id="authors"><a href="https://scholar.google.com/citations?user=UpOaYLoAAAAJ&hl=zh-CN">Jingbo Lin<sup>1</sup></a><a
        href="https://scholar.google.com/citations?user=8pIq2N0AAAAJ&hl=zh-CN">Zhilu Zhang<sup>1</sup></a><a
        href="https://github.com/YngMgC">Wenbo Li<sup>2</sup></a><a
        href="https://scholar.google.com/citations?user=4LsZhDgAAAAJ&hl=zh-CN&oi=ao">Renjing Pei<sup>2</sup></a>
      <br>
      <a
        href="https://scholar.google.com/citations?user=I4vuL7kAAAAJ&hl=zh-CN&oi=ao">Hang Xu<sup>2</sup></a><a
        href="https://scholar.google.com/citations?user=I4vuL7kAAAAJ&hl=zh-CN&oi=ao">Hongzhi Zhang<sup>1</sup></a><a
        href="https://scholar.google.com/citations?user=rUOpCEYAAAAJ&hl=zh-CN">Wangmeng Zuo<sup>1</sup></a><br>
    <br>
    <!--        <span style="font-size: 24px">KAIST-->
    <span style="font-size: 20px;"><sup>1</sup>Harbin Institute of Technology</span>   &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp   <span style="font-size: 20px;"><sup>2</sup>Huawei Noah's Ark Lab</span>

    <p style="text-align: center;font-size: 15px;">
        <a href="https://arxiv.org/abs/2412.20157" target="_blank">[Paper]</a> &nbsp;&nbsp;&nbsp;&nbsp;
        <a href="https://github.com/mrluin/UniRestorer" target="_blank">[Code]</a> &nbsp;&nbsp;&nbsp;&nbsp;
    </p>

    </span></p>

    <br>
    <img src="./files/radar.png" class="teaser-gif" style="width:100%;"><br>
    <p style="text-align: center;">
        Comparisons with task-agnostic methods, all-in-one methods, and task-specific models on all-in-one image restoration.
        <b> (a) </b> Comparisons on single-degradation setting.
        <b> (b) </b> Comparisons with specific single-task models.
        <b> (c) </b> Comparisons on mixed-degradation setting <i> (in-distribution) </i>.
        <b> (d) </b> Comparisons on mixed-degradation setting <i> (out-of-distribution) </i>.
    </p>
</div>

<div class="content">
    <h2>Abstract</h2>
    <p>
    Recently, considerable progress has been made in all-in-one image restoration.
    Generally, existing methods can be degradation-agnostic or degradation-aware.
    However, the former are limited in leveraging degradation-specific restoration, and the latter suffer from the inevitable error in degradation estimation.
    Consequently, the performance of existing methods has a large gap compared to specific single-task models.
    In this work, we make a step forward in this topic, and present our UniRestorer with improved restoration performance.
    Specifically, we perform hierarchical clustering on degradation space, and train a multi-granularity mixture-of-experts (MoE) restoration model.
    Then, UniRestorer adopts both degradation and granularity estimation to adaptively select an appropriate expert for image restoration.
    In contrast to existing degradation-agnostic and -aware methods, UniRestorer can leverage degradation estimation to benefit degradation-specific restoration, and use granularity estimation to make the model robust to degradation estimation error.
    Experimental results show that our UniRestorer outperforms state-of-the-art all-in-one methods by a large margin, and is promising in closing the performance gap to specific single-task models.
    The code and pre-trained models will be publicly available.
    </p>
</div>

<div class="content">
    <h2>Method</h2>
    <img class="summary-img" src="./files/framework.png" style="width:100%;"> <br>
    <p>
        <b> Illustration of our proposed UniRestorer. </b>
         We develop a multi-granularity degradation set by hierarchical clustering on extracted DRs at different granularity, i.e., 'ALL', 'TYPE', and 'DEGREE'.
         Based on the multi-granularity degradation set, we train a multi-granularity MoE restoration model.
         Besides vanilla degradation estimation, we introduce granularity estimation to indicate the degree of degradation estimation error.
        Adopting both degradation and granularity estimation, we train routers to adaptively allocate an expert to unknown corrupted input.
    </p>
    <br>
</div>

<div class="content">
    <h2>Quantitative Comparisons</h2>
    <p> All-in-One Image Restoration (single-degradation) results, All-in-One Image Restoration (mixed-degradation) results, comparisons with single-task image restoration models.</p>
    <center>
        <div id="myCarousel1" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ol class="carousel-indicators">
                <li data-target="#myCarousel1" data-slide-to="0" class="active"></li>
                <li data-target="#myCarousel1" data-slide-to="1"></li>
                <li data-target="#myCarousel1" data-slide-to="2"></li>
<!--                <li data-target="#myCarousel1" data-slide-to="3"></li>-->
            </ol>

            <!-- Wrapper for slides -->
            <div class="carousel-inner">
                <div class="item active">
                    <img src="./files/single_degraadtion_all_in_one.png" alt="Example 1" style="width:90%;">
                </div>

                <div class="item">
                    <img src="./files/mixed_degradation_all_in_one.png" alt="Example 2" style="width:90%;">
                </div>

                <div class="item">
                    <img src="./files/single_task_comparison.png" alt="Example 3" style="width:90%;">
                </div>
            </div>

            <!-- Left and right controls -->
            <a class="left carousel-control" href="#myCarousel1" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#myCarousel1" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </center>

</div>



</body>

</html>
